<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Mean Ceramic Dates | Caddo Chronology in the Neches River Basin</title>
  <meta name="description" content="Caddo chronology" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Mean Ceramic Dates | Caddo Chronology in the Neches River Basin" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Caddo chronology" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Mean Ceramic Dates | Caddo Chronology in the Neches River Basin" />
  
  <meta name="twitter:description" content="Caddo chronology" />
  

<meta name="author" content="Robert Z. Selden, Jr." />


<meta name="date" content="2021-05-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="seriation.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">neches.chron</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i><b>0.1</b> Acknowledgments</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#data-management"><i class="fa fa-check"></i><b>0.2</b> Data management</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#colophon"><i class="fa fa-check"></i><b>0.2.1</b> Colophon</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="mean-ceramic-dates.html"><a href="mean-ceramic-dates.html"><i class="fa fa-check"></i><b>1</b> Mean Ceramic Dates</a>
<ul>
<li class="chapter" data-level="1.1" data-path="mean-ceramic-dates.html"><a href="mean-ceramic-dates.html#plot-mcd-results-with-confidence-interval"><i class="fa fa-check"></i><b>1.1</b> Plot MCD results with confidence interval</a></li>
<li class="chapter" data-level="1.2" data-path="mean-ceramic-dates.html"><a href="mean-ceramic-dates.html#mcd2"><i class="fa fa-check"></i><b>1.2</b> MCD2</a></li>
<li class="chapter" data-level="1.3" data-path="mean-ceramic-dates.html"><a href="mean-ceramic-dates.html#plot-mcd2-results-with-confidence-interval"><i class="fa fa-check"></i><b>1.3</b> Plot MCD2 results with confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="seriation.html"><a href="seriation.html"><i class="fa fa-check"></i><b>2</b> Seriation</a></li>
<li class="chapter" data-level="3" data-path="radiocarbon.html"><a href="radiocarbon.html"><i class="fa fa-check"></i><b>3</b> Radiocarbon</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Caddo Chronology in the Neches River Basin</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mean-ceramic-dates" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Mean Ceramic Dates</h1>
<p>Sites selected for this study come from the Caddo Ceramic Vessel Database <span class="citation">(<a href="#ref-RN11605" role="doc-biblioref">Perttula 2017</a>)</span>, which were plotted using coordinates from the Texas Historic Sites Atlas, then clipped to the extent of the Neches River Basin. Mean ceramic dates were calculated and plotted using modified code originally developed by <a href="http://www.mattpeeples.net/mcd.html">Peeples (2011)</a>, who was following South <span class="citation">(<a href="#ref-RN21010" role="doc-biblioref">1972</a>, <a href="#ref-RN21011" role="doc-biblioref">1977</a>)</span>. Dates and probability ranges were subsequently plotted using the <code>ggplot2</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="mean-ceramic-dates.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set working directory</span></span>
<span id="cb1-2"><a href="mean-ceramic-dates.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code></pre></div>
<pre><code>## here() starts at E:/github/neches.chron/supp</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="mean-ceramic-dates.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read data</span></span>
<span id="cb3-2"><a href="mean-ceramic-dates.html#cb3-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&#39;nrb_mcd_data.csv&#39;</span>, </span>
<span id="cb3-3"><a href="mean-ceramic-dates.html#cb3-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">&#39;,&#39;</span>, </span>
<span id="cb3-4"><a href="mean-ceramic-dates.html#cb3-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header =</span> T, </span>
<span id="cb3-5"><a href="mean-ceramic-dates.html#cb3-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb3-6"><a href="mean-ceramic-dates.html#cb3-6" aria-hidden="true" tabindex="-1"></a>types <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">colnames</span>(mydata))</span>
<span id="cb3-7"><a href="mean-ceramic-dates.html#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="mean-ceramic-dates.html#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="mean-ceramic-dates.html#cb3-9" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&#39;nrb_type_dates.csv&#39;</span>, </span>
<span id="cb3-10"><a href="mean-ceramic-dates.html#cb3-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">&#39;,&#39;</span>, </span>
<span id="cb3-11"><a href="mean-ceramic-dates.html#cb3-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">header =</span> T)</span>
<span id="cb3-12"><a href="mean-ceramic-dates.html#cb3-12" aria-hidden="true" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">min</span>(dates[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb3-13"><a href="mean-ceramic-dates.html#cb3-13" aria-hidden="true" tabindex="-1"></a>dates[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> dates[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">+</span> (bc<span class="sc">*-</span><span class="dv">1</span>)</span>
<span id="cb3-14"><a href="mean-ceramic-dates.html#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="mean-ceramic-dates.html#cb3-15" aria-hidden="true" tabindex="-1"></a>midpt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(((dates[,<span class="dv">3</span>] <span class="sc">-</span> dates[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> dates[,<span class="dv">2</span>])</span>
<span id="cb3-16"><a href="mean-ceramic-dates.html#cb3-16" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates,midpt)</span>
<span id="cb3-17"><a href="mean-ceramic-dates.html#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="mean-ceramic-dates.html#cb3-18" aria-hidden="true" tabindex="-1"></a>mydata2 <span class="ot">&lt;-</span> mydata</span>
<span id="cb3-19"><a href="mean-ceramic-dates.html#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="mean-ceramic-dates.html#cb3-20" aria-hidden="true" tabindex="-1"></a>mcd.calc <span class="ot">&lt;-</span> <span class="cf">function</span>(x,types,dates) {</span>
<span id="cb3-21"><a href="mean-ceramic-dates.html#cb3-21" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(x))</span>
<span id="cb3-22"><a href="mean-ceramic-dates.html#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(types)) {</span>
<span id="cb3-23"><a href="mean-ceramic-dates.html#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dates)) {</span>
<span id="cb3-24"><a href="mean-ceramic-dates.html#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (types[i,] <span class="sc">==</span> dates[j,<span class="dv">1</span>]) </span>
<span id="cb3-25"><a href="mean-ceramic-dates.html#cb3-25" aria-hidden="true" tabindex="-1"></a>{x[,i] <span class="ot">&lt;-</span> x[,i] <span class="sc">*</span> dates[j,<span class="dv">4</span>]}}}</span>
<span id="cb3-26"><a href="mean-ceramic-dates.html#cb3-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-27"><a href="mean-ceramic-dates.html#cb3-27" aria-hidden="true" tabindex="-1"></a>mcd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(mydata), <span class="dv">1</span>)</span>
<span id="cb3-28"><a href="mean-ceramic-dates.html#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mcd) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mydata)</span>
<span id="cb3-29"><a href="mean-ceramic-dates.html#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="mean-ceramic-dates.html#cb3-30" aria-hidden="true" tabindex="-1"></a>newtot <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(x))</span>
<span id="cb3-31"><a href="mean-ceramic-dates.html#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="mean-ceramic-dates.html#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mcd)) {</span>
<span id="cb3-33"><a href="mean-ceramic-dates.html#cb3-33" aria-hidden="true" tabindex="-1"></a>mcd[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> newtot[i,] <span class="sc">/</span> tot[i,] <span class="sc">+</span> bc}</span>
<span id="cb3-34"><a href="mean-ceramic-dates.html#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(mcd)} </span>
<span id="cb3-35"><a href="mean-ceramic-dates.html#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="mean-ceramic-dates.html#cb3-36" aria-hidden="true" tabindex="-1"></a>mcd <span class="ot">&lt;-</span> <span class="fu">mcd.calc</span>(mydata2, types, dates)</span>
<span id="cb3-37"><a href="mean-ceramic-dates.html#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="mean-ceramic-dates.html#cb3-38" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb3-39"><a href="mean-ceramic-dates.html#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="mean-ceramic-dates.html#cb3-40" aria-hidden="true" tabindex="-1"></a>data.rowsum <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(mydata))</span>
<span id="cb3-41"><a href="mean-ceramic-dates.html#cb3-41" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(mydata), <span class="dv">2</span>)</span>
<span id="cb3-42"><a href="mean-ceramic-dates.html#cb3-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-43"><a href="mean-ceramic-dates.html#cb3-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mydata)) {</span>
<span id="cb3-44"><a href="mean-ceramic-dates.html#cb3-44" aria-hidden="true" tabindex="-1"></a>data.sim <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(nsim, data.rowsum[i,], <span class="at">prob =</span> mydata[i,])</span>
<span id="cb3-45"><a href="mean-ceramic-dates.html#cb3-45" aria-hidden="true" tabindex="-1"></a>data.sim <span class="ot">&lt;-</span> <span class="fu">t</span>(data.sim)</span>
<span id="cb3-46"><a href="mean-ceramic-dates.html#cb3-46" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">mcd.calc</span>(data.sim, types,dates)</span>
<span id="cb3-47"><a href="mean-ceramic-dates.html#cb3-47" aria-hidden="true" tabindex="-1"></a>range[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">-</span> (<span class="fu">sd</span>(temp)<span class="sc">*</span><span class="fl">1.96</span>)</span>
<span id="cb3-48"><a href="mean-ceramic-dates.html#cb3-48" aria-hidden="true" tabindex="-1"></a>range[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">+</span> (<span class="fu">sd</span>(temp)<span class="sc">*</span><span class="fl">1.96</span>)}</span>
<span id="cb3-49"><a href="mean-ceramic-dates.html#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="mean-ceramic-dates.html#cb3-50" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">row.names</span>(mydata), mcd, range)</span>
<span id="cb3-51"><a href="mean-ceramic-dates.html#cb3-51" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;site&#39;</span>, <span class="st">&#39;mcd&#39;</span>, <span class="st">&#39;lower&#39;</span>, <span class="st">&#39;higher&#39;</span>)</span>
<span id="cb3-52"><a href="mean-ceramic-dates.html#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="mean-ceramic-dates.html#cb3-53" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(output, <span class="at">file =</span> <span class="st">&#39;mcd_out.csv&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;,&#39;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
<div id="plot-mcd-results-with-confidence-interval" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Plot MCD results with confidence interval</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="mean-ceramic-dates.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mean ceramic dates with error bars</span></span>
<span id="cb4-2"><a href="mean-ceramic-dates.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># if you use the Rmd file included in the GitHub repository, it will export a publication-ready figure at 600dpi in the mcd_files folder</span></span>
<span id="cb4-3"><a href="mean-ceramic-dates.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="mean-ceramic-dates.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github(&quot;tidyverse/ggplot2&quot;)</span></span>
<span id="cb4-5"><a href="mean-ceramic-dates.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co"># load ggplot2</span></span>
<span id="cb4-6"><a href="mean-ceramic-dates.html#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="mean-ceramic-dates.html#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co"># read mcd_out</span></span>
<span id="cb4-8"><a href="mean-ceramic-dates.html#cb4-8" aria-hidden="true" tabindex="-1"></a>caddo <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;mcd_out.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">as.is =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-9"><a href="mean-ceramic-dates.html#cb4-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(caddo, <span class="st">&quot;pipe&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Attributes included in table.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:ggplot">Table 1.1: </span>Attributes included in table.</caption>
<thead>
<tr class="header">
<th align="left">site</th>
<th align="right">mcd</th>
<th align="right">lower</th>
<th align="right">higher</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">41SM56</td>
<td align="right">1116.667</td>
<td align="right">1089.799</td>
<td align="right">1140.133</td>
</tr>
<tr class="even">
<td align="left">41SM55</td>
<td align="right">1250.000</td>
<td align="right">1250.000</td>
<td align="right">1250.000</td>
</tr>
<tr class="odd">
<td align="left">41SM77</td>
<td align="right">1548.750</td>
<td align="right">1524.422</td>
<td align="right">1568.874</td>
</tr>
<tr class="even">
<td align="left">41SM90</td>
<td align="right">1530.625</td>
<td align="right">1524.734</td>
<td align="right">1535.827</td>
</tr>
<tr class="odd">
<td align="left">41SM73</td>
<td align="right">1206.250</td>
<td align="right">1030.632</td>
<td align="right">1355.847</td>
</tr>
<tr class="even">
<td align="left">41SM93</td>
<td align="right">1538.500</td>
<td align="right">1533.177</td>
<td align="right">1544.007</td>
</tr>
<tr class="odd">
<td align="left">41SM151</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
</tr>
<tr class="even">
<td align="left">41SM158</td>
<td align="right">1532.500</td>
<td align="right">1523.409</td>
<td align="right">1541.897</td>
</tr>
<tr class="odd">
<td align="left">41SM249</td>
<td align="right">1535.000</td>
<td align="right">1527.828</td>
<td align="right">1541.968</td>
</tr>
<tr class="even">
<td align="left">41SM150</td>
<td align="right">1346.667</td>
<td align="right">1228.721</td>
<td align="right">1480.395</td>
</tr>
<tr class="odd">
<td align="left">41SM355</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
</tr>
<tr class="even">
<td align="left">41SM2</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="odd">
<td align="left">41HE114</td>
<td align="right">1535.263</td>
<td align="right">1530.527</td>
<td align="right">1539.838</td>
</tr>
<tr class="even">
<td align="left">41HE4</td>
<td align="right">1532.500</td>
<td align="right">1527.468</td>
<td align="right">1539.981</td>
</tr>
<tr class="odd">
<td align="left">41HE75</td>
<td align="right">1531.667</td>
<td align="right">1526.575</td>
<td align="right">1535.738</td>
</tr>
<tr class="even">
<td align="left">41HE78</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="odd">
<td align="left">41HE82</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
</tr>
<tr class="even">
<td align="left">41AN201</td>
<td align="right">1528.750</td>
<td align="right">1521.894</td>
<td align="right">1535.300</td>
</tr>
<tr class="odd">
<td align="left">41CE4</td>
<td align="right">1532.143</td>
<td align="right">1528.965</td>
<td align="right">1535.059</td>
</tr>
<tr class="even">
<td align="left">41CE12</td>
<td align="right">1589.135</td>
<td align="right">1570.481</td>
<td align="right">1612.113</td>
</tr>
<tr class="odd">
<td align="left">41CE14</td>
<td align="right">1528.571</td>
<td align="right">1527.119</td>
<td align="right">1530.001</td>
</tr>
<tr class="even">
<td align="left">41CE15</td>
<td align="right">1601.667</td>
<td align="right">1508.420</td>
<td align="right">1705.185</td>
</tr>
<tr class="odd">
<td align="left">41CE17</td>
<td align="right">1530.192</td>
<td align="right">1527.697</td>
<td align="right">1532.971</td>
</tr>
<tr class="even">
<td align="left">41CE19</td>
<td align="right">1076.273</td>
<td align="right">1050.692</td>
<td align="right">1098.667</td>
</tr>
<tr class="odd">
<td align="left">41CE23</td>
<td align="right">1535.000</td>
<td align="right">1528.746</td>
<td align="right">1540.234</td>
</tr>
<tr class="even">
<td align="left">41CE25</td>
<td align="right">1547.000</td>
<td align="right">1523.682</td>
<td align="right">1566.506</td>
</tr>
<tr class="odd">
<td align="left">41CE421</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="even">
<td align="left">41CE6</td>
<td align="right">1645.833</td>
<td align="right">1568.702</td>
<td align="right">1689.359</td>
</tr>
<tr class="odd">
<td align="left">41AN1</td>
<td align="right">1532.759</td>
<td align="right">1529.832</td>
<td align="right">1535.728</td>
</tr>
<tr class="even">
<td align="left">41AN13</td>
<td align="right">1692.692</td>
<td align="right">1647.232</td>
<td align="right">1741.293</td>
</tr>
<tr class="odd">
<td align="left">41AN14</td>
<td align="right">1527.727</td>
<td align="right">1524.956</td>
<td align="right">1530.999</td>
</tr>
<tr class="even">
<td align="left">41AN16</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="odd">
<td align="left">41AN18</td>
<td align="right">1532.500</td>
<td align="right">1521.673</td>
<td align="right">1541.797</td>
</tr>
<tr class="even">
<td align="left">41AN184</td>
<td align="right">1596.667</td>
<td align="right">1479.197</td>
<td align="right">1708.286</td>
</tr>
<tr class="odd">
<td align="left">41AN2</td>
<td align="right">1555.625</td>
<td align="right">1522.736</td>
<td align="right">1585.185</td>
</tr>
<tr class="even">
<td align="left">41AN21</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="odd">
<td align="left">41AN26</td>
<td align="right">1716.111</td>
<td align="right">1689.858</td>
<td align="right">1741.389</td>
</tr>
<tr class="even">
<td align="left">41AN32</td>
<td align="right">1538.750</td>
<td align="right">1519.731</td>
<td align="right">1555.065</td>
</tr>
<tr class="odd">
<td align="left">41AN34</td>
<td align="right">1540.278</td>
<td align="right">1518.929</td>
<td align="right">1559.178</td>
</tr>
<tr class="even">
<td align="left">41AN38</td>
<td align="right">1528.750</td>
<td align="right">1524.789</td>
<td align="right">1533.119</td>
</tr>
<tr class="odd">
<td align="left">41AN39</td>
<td align="right">1529.286</td>
<td align="right">1524.768</td>
<td align="right">1534.066</td>
</tr>
<tr class="even">
<td align="left">41AN44</td>
<td align="right">1535.909</td>
<td align="right">1532.298</td>
<td align="right">1539.576</td>
</tr>
<tr class="odd">
<td align="left">41AN48</td>
<td align="right">1532.500</td>
<td align="right">1520.732</td>
<td align="right">1541.819</td>
</tr>
<tr class="even">
<td align="left">41AN53</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="odd">
<td align="left">41AN54</td>
<td align="right">1545.714</td>
<td align="right">1515.846</td>
<td align="right">1578.076</td>
</tr>
<tr class="even">
<td align="left">41AN56</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
<td align="right">1540.000</td>
</tr>
<tr class="odd">
<td align="left">41AN57</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="even">
<td align="left">41AN67</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
<td align="right">1525.000</td>
</tr>
<tr class="odd">
<td align="left">41AG66</td>
<td align="right">1250.000</td>
<td align="right">1250.000</td>
<td align="right">1250.000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="mean-ceramic-dates.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder sites by mcd</span></span>
<span id="cb5-2"><a href="mean-ceramic-dates.html#cb5-2" aria-hidden="true" tabindex="-1"></a>caddo<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(caddo<span class="sc">$</span>site, <span class="at">levels =</span> caddo<span class="sc">$</span>site[<span class="fu">order</span>(caddo<span class="sc">$</span>mcd)])</span>
<span id="cb5-3"><a href="mean-ceramic-dates.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="mean-ceramic-dates.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb5-5"><a href="mean-ceramic-dates.html#cb5-5" aria-hidden="true" tabindex="-1"></a>Site <span class="ot">&lt;-</span> caddo<span class="sc">$</span>site</span>
<span id="cb5-6"><a href="mean-ceramic-dates.html#cb5-6" aria-hidden="true" tabindex="-1"></a>Mean_Ceramic_Date_CE <span class="ot">&lt;-</span> caddo<span class="sc">$</span>mcd</span>
<span id="cb5-7"><a href="mean-ceramic-dates.html#cb5-7" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> caddo<span class="sc">$</span>lower</span>
<span id="cb5-8"><a href="mean-ceramic-dates.html#cb5-8" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> caddo<span class="sc">$</span>higher</span>
<span id="cb5-9"><a href="mean-ceramic-dates.html#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="mean-ceramic-dates.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot that includes the mean ceramic date and the 95% probability range reordered by mcd</span></span>
<span id="cb5-11"><a href="mean-ceramic-dates.html#cb5-11" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">=</span> <span class="fu">theme</span>(</span>
<span id="cb5-12"><a href="mean-ceramic-dates.html#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb5-13"><a href="mean-ceramic-dates.html#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb5-14"><a href="mean-ceramic-dates.html#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb5-15"><a href="mean-ceramic-dates.html#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb5-16"><a href="mean-ceramic-dates.html#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="mean-ceramic-dates.html#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb5-18"><a href="mean-ceramic-dates.html#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> caddo, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> <span class="co"># for colour publications, I recommend using &quot;gray&quot;</span></span>
<span id="cb5-19"><a href="mean-ceramic-dates.html#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> caddo, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> Mean_Ceramic_Date_CE), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-20"><a href="mean-ceramic-dates.html#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="co"># provides a representation of time similar to what archaeologists are used to seeing</span></span>
<span id="cb5-21"><a href="mean-ceramic-dates.html#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Archaeological Site&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Date Range CE&quot;</span>) <span class="sc">+</span> <span class="co"># the axes are flipped, so x = y and y = x</span></span>
<span id="cb5-22"><a href="mean-ceramic-dates.html#cb5-22" aria-hidden="true" tabindex="-1"></a>  cs</span></code></pre></div>
<div class="figure"><span id="fig:ggplot"></span>
<img src="supp_files/figure-html/ggplot-1.png" alt="Mean ceramic dates and 95% probability ranges for Caddo sites in the Neches River basin." width="100%" />
<p class="caption">
Figure 1.1: Mean ceramic dates and 95% probability ranges for Caddo sites in the Neches River basin.
</p>
</div>
</div>
<div id="mcd2" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> MCD2</h2>
<p>Mean ceramic dates for types with five or more vessels represented in the sample were calculated as a means of making these data easier to read for the comparison with the seriation results.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="mean-ceramic-dates.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read data</span></span>
<span id="cb6-2"><a href="mean-ceramic-dates.html#cb6-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&#39;nrb2_mcd_data.csv&#39;</span>, </span>
<span id="cb6-3"><a href="mean-ceramic-dates.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sep =</span> <span class="st">&#39;,&#39;</span>, </span>
<span id="cb6-4"><a href="mean-ceramic-dates.html#cb6-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">header =</span> T, </span>
<span id="cb6-5"><a href="mean-ceramic-dates.html#cb6-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">row.names =</span> <span class="dv">1</span>)</span>
<span id="cb6-6"><a href="mean-ceramic-dates.html#cb6-6" aria-hidden="true" tabindex="-1"></a>types <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">colnames</span>(mydata))</span>
<span id="cb6-7"><a href="mean-ceramic-dates.html#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="mean-ceramic-dates.html#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="mean-ceramic-dates.html#cb6-9" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&#39;nrb2_type_dates.csv&#39;</span>, </span>
<span id="cb6-10"><a href="mean-ceramic-dates.html#cb6-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">sep =</span> <span class="st">&#39;,&#39;</span>, </span>
<span id="cb6-11"><a href="mean-ceramic-dates.html#cb6-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">header =</span> T)</span>
<span id="cb6-12"><a href="mean-ceramic-dates.html#cb6-12" aria-hidden="true" tabindex="-1"></a>bc <span class="ot">&lt;-</span> <span class="fu">min</span>(dates[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb6-13"><a href="mean-ceramic-dates.html#cb6-13" aria-hidden="true" tabindex="-1"></a>dates[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> dates[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">+</span> (bc<span class="sc">*-</span><span class="dv">1</span>)</span>
<span id="cb6-14"><a href="mean-ceramic-dates.html#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="mean-ceramic-dates.html#cb6-15" aria-hidden="true" tabindex="-1"></a>midpt <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(((dates[,<span class="dv">3</span>] <span class="sc">-</span> dates[,<span class="dv">2</span>])<span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span> dates[,<span class="dv">2</span>])</span>
<span id="cb6-16"><a href="mean-ceramic-dates.html#cb6-16" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates,midpt)</span>
<span id="cb6-17"><a href="mean-ceramic-dates.html#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="mean-ceramic-dates.html#cb6-18" aria-hidden="true" tabindex="-1"></a>mydata2 <span class="ot">&lt;-</span> mydata</span>
<span id="cb6-19"><a href="mean-ceramic-dates.html#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="mean-ceramic-dates.html#cb6-20" aria-hidden="true" tabindex="-1"></a>mcd.calc <span class="ot">&lt;-</span> <span class="cf">function</span>(x,types,dates) {</span>
<span id="cb6-21"><a href="mean-ceramic-dates.html#cb6-21" aria-hidden="true" tabindex="-1"></a>tot <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(x))</span>
<span id="cb6-22"><a href="mean-ceramic-dates.html#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(types)) {</span>
<span id="cb6-23"><a href="mean-ceramic-dates.html#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dates)) {</span>
<span id="cb6-24"><a href="mean-ceramic-dates.html#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (types[i,] <span class="sc">==</span> dates[j,<span class="dv">1</span>]) </span>
<span id="cb6-25"><a href="mean-ceramic-dates.html#cb6-25" aria-hidden="true" tabindex="-1"></a>{x[,i] <span class="ot">&lt;-</span> x[,i] <span class="sc">*</span> dates[j,<span class="dv">4</span>]}}}</span>
<span id="cb6-26"><a href="mean-ceramic-dates.html#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="mean-ceramic-dates.html#cb6-27" aria-hidden="true" tabindex="-1"></a>mcd <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(mydata), <span class="dv">1</span>)</span>
<span id="cb6-28"><a href="mean-ceramic-dates.html#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mcd) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mydata)</span>
<span id="cb6-29"><a href="mean-ceramic-dates.html#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="mean-ceramic-dates.html#cb6-30" aria-hidden="true" tabindex="-1"></a>newtot <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(x))</span>
<span id="cb6-31"><a href="mean-ceramic-dates.html#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="mean-ceramic-dates.html#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mcd)) {</span>
<span id="cb6-33"><a href="mean-ceramic-dates.html#cb6-33" aria-hidden="true" tabindex="-1"></a>mcd[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> newtot[i,] <span class="sc">/</span> tot[i,] <span class="sc">+</span> bc}</span>
<span id="cb6-34"><a href="mean-ceramic-dates.html#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(mcd)} </span>
<span id="cb6-35"><a href="mean-ceramic-dates.html#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="mean-ceramic-dates.html#cb6-36" aria-hidden="true" tabindex="-1"></a>mcd <span class="ot">&lt;-</span> <span class="fu">mcd.calc</span>(mydata2, types, dates)</span>
<span id="cb6-37"><a href="mean-ceramic-dates.html#cb6-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-38"><a href="mean-ceramic-dates.html#cb6-38" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb6-39"><a href="mean-ceramic-dates.html#cb6-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-40"><a href="mean-ceramic-dates.html#cb6-40" aria-hidden="true" tabindex="-1"></a>data.rowsum <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">rowSums</span>(mydata))</span>
<span id="cb6-41"><a href="mean-ceramic-dates.html#cb6-41" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(mydata), <span class="dv">2</span>)</span>
<span id="cb6-42"><a href="mean-ceramic-dates.html#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="mean-ceramic-dates.html#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mydata)) {</span>
<span id="cb6-44"><a href="mean-ceramic-dates.html#cb6-44" aria-hidden="true" tabindex="-1"></a>data.sim <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(nsim, data.rowsum[i,], <span class="at">prob =</span> mydata[i,])</span>
<span id="cb6-45"><a href="mean-ceramic-dates.html#cb6-45" aria-hidden="true" tabindex="-1"></a>data.sim <span class="ot">&lt;-</span> <span class="fu">t</span>(data.sim)</span>
<span id="cb6-46"><a href="mean-ceramic-dates.html#cb6-46" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="fu">mcd.calc</span>(data.sim, types,dates)</span>
<span id="cb6-47"><a href="mean-ceramic-dates.html#cb6-47" aria-hidden="true" tabindex="-1"></a>range[i,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">-</span> (<span class="fu">sd</span>(temp)<span class="sc">*</span><span class="fl">1.96</span>)</span>
<span id="cb6-48"><a href="mean-ceramic-dates.html#cb6-48" aria-hidden="true" tabindex="-1"></a>range[i,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">+</span> (<span class="fu">sd</span>(temp)<span class="sc">*</span><span class="fl">1.96</span>)}</span>
<span id="cb6-49"><a href="mean-ceramic-dates.html#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="mean-ceramic-dates.html#cb6-50" aria-hidden="true" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">row.names</span>(mydata), mcd, range)</span>
<span id="cb6-51"><a href="mean-ceramic-dates.html#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(output) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;site&#39;</span>, <span class="st">&#39;mcd&#39;</span>, <span class="st">&#39;lower&#39;</span>, <span class="st">&#39;higher&#39;</span>)</span>
<span id="cb6-52"><a href="mean-ceramic-dates.html#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="mean-ceramic-dates.html#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(output, <span class="at">file =</span> <span class="st">&#39;mcd_out2.csv&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;,&#39;</span>, <span class="at">row.names =</span> F)</span></code></pre></div>
</div>
<div id="plot-mcd2-results-with-confidence-interval" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> Plot MCD2 results with confidence interval</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="mean-ceramic-dates.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot mean ceramic dates with error bars</span></span>
<span id="cb7-2"><a href="mean-ceramic-dates.html#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="mean-ceramic-dates.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read mcd_out</span></span>
<span id="cb7-4"><a href="mean-ceramic-dates.html#cb7-4" aria-hidden="true" tabindex="-1"></a>caddo <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;mcd_out2.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">as.is =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-5"><a href="mean-ceramic-dates.html#cb7-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(caddo, <span class="st">&quot;pipe&quot;</span>, <span class="at">caption =</span> <span class="st">&quot;Attributes included in table.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:ggplot2">Table 1.2: </span>Attributes included in table.</caption>
<thead>
<tr class="header">
<th align="left">site</th>
<th align="right">mcd</th>
<th align="right">lower</th>
<th align="right">higher</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">41SM77</td>
<td align="right">1548.7500</td>
<td align="right">1522.5572</td>
<td align="right">1576.859</td>
</tr>
<tr class="even">
<td align="left">41SM90</td>
<td align="right">1530.6250</td>
<td align="right">1525.8815</td>
<td align="right">1534.900</td>
</tr>
<tr class="odd">
<td align="left">41SM93</td>
<td align="right">1538.5000</td>
<td align="right">1533.8654</td>
<td align="right">1542.760</td>
</tr>
<tr class="even">
<td align="left">41SM150</td>
<td align="right">1346.6667</td>
<td align="right">1235.7968</td>
<td align="right">1465.592</td>
</tr>
<tr class="odd">
<td align="left">41HE114</td>
<td align="right">1535.2632</td>
<td align="right">1530.4833</td>
<td align="right">1540.240</td>
</tr>
<tr class="even">
<td align="left">41HE75</td>
<td align="right">1531.6667</td>
<td align="right">1526.1993</td>
<td align="right">1538.523</td>
</tr>
<tr class="odd">
<td align="left">41CE4</td>
<td align="right">1532.1429</td>
<td align="right">1528.8778</td>
<td align="right">1535.110</td>
</tr>
<tr class="even">
<td align="left">41CE12</td>
<td align="right">1589.1346</td>
<td align="right">1571.1390</td>
<td align="right">1610.231</td>
</tr>
<tr class="odd">
<td align="left">41CE14</td>
<td align="right">1528.5714</td>
<td align="right">1527.4704</td>
<td align="right">1529.851</td>
</tr>
<tr class="even">
<td align="left">41CE17</td>
<td align="right">1530.1923</td>
<td align="right">1527.2389</td>
<td align="right">1533.050</td>
</tr>
<tr class="odd">
<td align="left">41CE19</td>
<td align="right">985.8182</td>
<td align="right">951.7532</td>
<td align="right">1011.599</td>
</tr>
<tr class="even">
<td align="left">41CE23</td>
<td align="right">1535.0000</td>
<td align="right">1528.9626</td>
<td align="right">1541.662</td>
</tr>
<tr class="odd">
<td align="left">41CE25</td>
<td align="right">1547.0000</td>
<td align="right">1525.8804</td>
<td align="right">1574.953</td>
</tr>
<tr class="even">
<td align="left">41CE6</td>
<td align="right">1645.8333</td>
<td align="right">1554.6922</td>
<td align="right">1724.613</td>
</tr>
<tr class="odd">
<td align="left">41AN1</td>
<td align="right">1532.7586</td>
<td align="right">1529.8894</td>
<td align="right">1535.757</td>
</tr>
<tr class="even">
<td align="left">41AN13</td>
<td align="right">1692.6923</td>
<td align="right">1650.3282</td>
<td align="right">1747.973</td>
</tr>
<tr class="odd">
<td align="left">41AN14</td>
<td align="right">1527.7273</td>
<td align="right">1524.2386</td>
<td align="right">1532.580</td>
</tr>
<tr class="even">
<td align="left">41AN2</td>
<td align="right">1555.6250</td>
<td align="right">1520.2311</td>
<td align="right">1597.660</td>
</tr>
<tr class="odd">
<td align="left">41AN26</td>
<td align="right">1716.1111</td>
<td align="right">1689.4465</td>
<td align="right">1741.449</td>
</tr>
<tr class="even">
<td align="left">41AN32</td>
<td align="right">1538.7500</td>
<td align="right">1514.3782</td>
<td align="right">1563.122</td>
</tr>
<tr class="odd">
<td align="left">41AN34</td>
<td align="right">1540.2778</td>
<td align="right">1515.8079</td>
<td align="right">1570.234</td>
</tr>
<tr class="even">
<td align="left">41AN38</td>
<td align="right">1528.7500</td>
<td align="right">1525.3525</td>
<td align="right">1533.398</td>
</tr>
<tr class="odd">
<td align="left">41AN44</td>
<td align="right">1535.9091</td>
<td align="right">1532.9585</td>
<td align="right">1539.769</td>
</tr>
<tr class="even">
<td align="left">41AN54</td>
<td align="right">1545.7143</td>
<td align="right">1513.6664</td>
<td align="right">1582.881</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="mean-ceramic-dates.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reorder sites by mcd</span></span>
<span id="cb8-2"><a href="mean-ceramic-dates.html#cb8-2" aria-hidden="true" tabindex="-1"></a>caddo<span class="sc">$</span>site <span class="ot">&lt;-</span> <span class="fu">factor</span>(caddo<span class="sc">$</span>site, <span class="at">levels =</span> caddo<span class="sc">$</span>site[<span class="fu">order</span>(caddo<span class="sc">$</span>mcd)])</span>
<span id="cb8-3"><a href="mean-ceramic-dates.html#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="mean-ceramic-dates.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># define variables</span></span>
<span id="cb8-5"><a href="mean-ceramic-dates.html#cb8-5" aria-hidden="true" tabindex="-1"></a>Site <span class="ot">&lt;-</span> caddo<span class="sc">$</span>site</span>
<span id="cb8-6"><a href="mean-ceramic-dates.html#cb8-6" aria-hidden="true" tabindex="-1"></a>Mean_Ceramic_Date_CE <span class="ot">&lt;-</span> caddo<span class="sc">$</span>mcd</span>
<span id="cb8-7"><a href="mean-ceramic-dates.html#cb8-7" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> caddo<span class="sc">$</span>lower</span>
<span id="cb8-8"><a href="mean-ceramic-dates.html#cb8-8" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> caddo<span class="sc">$</span>higher</span>
<span id="cb8-9"><a href="mean-ceramic-dates.html#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="mean-ceramic-dates.html#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plot that includes the mean ceramic date and the 95% probability range reordered by mcd</span></span>
<span id="cb8-11"><a href="mean-ceramic-dates.html#cb8-11" aria-hidden="true" tabindex="-1"></a>cs <span class="ot">=</span> <span class="fu">theme</span>(</span>
<span id="cb8-12"><a href="mean-ceramic-dates.html#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb8-13"><a href="mean-ceramic-dates.html#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb8-14"><a href="mean-ceramic-dates.html#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb8-15"><a href="mean-ceramic-dates.html#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span>
<span id="cb8-16"><a href="mean-ceramic-dates.html#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="mean-ceramic-dates.html#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb8-18"><a href="mean-ceramic-dates.html#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> caddo, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> <span class="co"># for colour publications, I recommend using &quot;gray&quot;</span></span>
<span id="cb8-19"><a href="mean-ceramic-dates.html#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> caddo, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Site, <span class="at">y =</span> Mean_Ceramic_Date_CE), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-20"><a href="mean-ceramic-dates.html#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> <span class="co"># provides a representation of time similar to what archaeologists are used to seeing</span></span>
<span id="cb8-21"><a href="mean-ceramic-dates.html#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Archaeological Site&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Date Range CE&quot;</span>) <span class="sc">+</span> <span class="co"># the axes are flipped, so x = y and y = x</span></span>
<span id="cb8-22"><a href="mean-ceramic-dates.html#cb8-22" aria-hidden="true" tabindex="-1"></a>  cs</span></code></pre></div>
<div class="figure"><span id="fig:ggplot2"></span>
<img src="supp_files/figure-html/ggplot2-1.png" alt="Mean ceramic dates and 95% probability ranges for Caddo sites in the Neches River basin." width="100%" />
<p class="caption">
Figure 1.2: Mean ceramic dates and 95% probability ranges for Caddo sites in the Neches River basin.
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-RN11605" class="csl-entry">
Perttula, Timothy K. 2017. <span>Caddo Ceramic Vessel Database from Sites in Texas, Louisiana, Oklahoma, and Arkansas.</span> <em>Journal of Northeast Texas Archaeology</em> 71: 14754.
</div>
<div id="ref-RN21010" class="csl-entry">
South, Stanley A. 1972. <span>Evolution and Horizon as Revealed in Ceramic Analysis in Historical Archaeology.</span> <em>Conference on Historic Site Archaeology Papers</em> 6 (2): 71116.
</div>
<div id="ref-RN21011" class="csl-entry">
. 1977. <em>Method and Theory in Historical Archaeology</em>. New York: Academic Press.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="seriation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["supp.pdf", "supp.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
